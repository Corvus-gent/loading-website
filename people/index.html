<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>People | corvus.gent</title>
  <link rel="icon" type="image/png" href="/logo.png" />
  <link rel="stylesheet" href="/styles.css" />
  <link rel="stylesheet" href="/people/styles.css" />
</head>
<body class="people-page">
  <main>
    <div class="wrap">
      <div class="tag">
        <a href="/">corvus.gent</a> / <span id="crumb-people">people</span><span id="crumb-id-wrap"></span>
      </div>

      <!-- lijst-weergave -->
      <section id="people-list-view">
        <h1>People @ Corvus</h1>
        <div>&nbsp;</div>
        <ul id="people-list" class="people-list"></ul>
      </section>

      <!-- detail-weergave -->
      <section id="person-view" class="person-view-wrap" style="display:none;">
        <h1 id="person-name"></h1>
        <p class="sub" id="person-position"></p>

        <section>
          </tr>
          <h2>About</h2>
          <p id="person-about" class="person-about"></p>
        </section>

        <section>
          <h2>Contacts</h2>
          <ul class="contact-list" id="person-links"></ul>
        </section>
      </section>

      <div>&nbsp;</div>
      <div>&nbsp;</div>
      <div>&nbsp;</div>

      <p class="sub people-sub">
        contact us <a href="mailto:hello@corvus.gent">hello@corvus.gent</a> if you think you got what it takes
      </p>

      <footer>
        Â© <span id="y"></span> corvus
      </footer>
    </div>
  </main>

  <script type="module">
    document.getElementById("y").textContent = new Date().getFullYear();

    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    const crumbIdWrap = document.getElementById("crumb-id-wrap");
    const listView = document.getElementById("people-list-view");
    const personView = document.getElementById("person-view");

    fetch("/people/people.json")
      .then(r => r.json())
      .then(data => {
        if (!id) {
          // LIST VIEW (/people)
          const list = document.getElementById("people-list");
          data.members.forEach(m => {
            const li = document.createElement("li");
            li.className = "people-item";
            li.innerHTML = `
              <a href="/people?id=${m.id}">
                <span class="people-name">${m.name}</span> -
                <span class="people-position">${m.position}</span>
              </a>
            `;
            list.appendChild(li);
          });
        } else {
          // DETAIL VIEW (/people?id=gabriel)
          const member = data.members.find(m => m.id === id);

          crumbIdWrap.textContent = " / " + id;

          if (!member) {
            personView.style.display = "block";
            listView.style.display = "none";
            personView.innerHTML = "<p class='sub'>Person not found.</p>";
            return;
          }

          listView.style.display = "none";
          personView.style.display = "block";

          document.getElementById("person-name").textContent = member.name;
          document.getElementById("person-about").textContent = member.about;

          const linksUl = document.getElementById("person-links");
          if (member.links && member.links.length) {
            member.links.forEach(l => {
              const li = document.createElement("li");
              li.innerHTML = `
                <a href="${l.href}" target="_blank" rel="noreferrer">
                  ${l.text}
                </a>
              `;
              linksUl.appendChild(li);
            });
          } else {
            linksUl.innerHTML = "<li><span class='sub'>No links yet.</span></li>";
          }
        }
      });
  </script>
</body>
</html>
